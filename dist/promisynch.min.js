!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.Promisynch=r()}(this,function(){"use strict";var e=function(t){return null!=t&&"object"==typeof t&&!1===Array.isArray(t)};function u(t){return!0==(null!=(r=t)&&"object"==typeof r&&!1===Array.isArray(r))&&"[object Object]"===Object.prototype.toString.call(t);var r}var a=Object.prototype.toString,n=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var r,n,e,u,o,i=typeof t;if("boolean"===i)return"boolean";if("string"===i)return"string";if("number"===i)return"number";if("symbol"===i)return"symbol";if("function"===i)return"GeneratorFunction"===s(t)?"generatorfunction":"function";if(r=t,Array.isArray?Array.isArray(r):r instanceof Array)return"array";if(function(t){if(t.constructor&&"function"==typeof t.constructor.isBuffer)return t.constructor.isBuffer(t);return!1}(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return!0}catch(t){if(-1!=t.message.indexOf("callee"))return!0}return!1}(t))return"arguments";if((n=t)instanceof Date||"function"==typeof n.toDateString&&"function"==typeof n.getDate&&"function"==typeof n.setDate)return"date";if((e=t)instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit)return"error";if((u=t)instanceof RegExp||"string"==typeof u.flags&&"boolean"==typeof u.ignoreCase&&"boolean"==typeof u.multiline&&"boolean"==typeof u.global)return"regexp";switch(s(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if("function"==typeof(o=t).throw&&"function"==typeof o.return&&"function"==typeof o.next)return"generator";switch(i=a.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return i.slice(8,-1).toLowerCase().replace(/\s/g,"")};function s(t){return t.constructor?t.constructor.name:null}var o={};["Array","Number","Function","RegExp","Boolean","Date","Error","Arguments","Null","String"].forEach(function(r){o[r]=function(t){return n(t)===r.toLowerCase()}});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var c=Object.assign(o,{Undefined:function(t){return null==t},Defined:function(t){return null!=t},Element:function(t){return"object"===(void 0===t?"undefined":r(t))&&1===t.nodeType},Window:function(t){return null!=t&&t===t.window},Document:function(t){return"object"===(void 0===t?"undefined":i(t))&&9===t.nodeType},PlainObject:function(t){var r,n;return!1!==u(t)&&"function"==typeof(r=t.constructor)&&!1!==u(n=r.prototype)&&0!=n.hasOwnProperty("isPrototypeOf")},Object:e,ArrayLike:function(t){var r,n=e(r=t)?r.length:void 0;return o.Number(n)&&0<=n&&n<=9007199254740991},isItClass:function(r){return function(t){return t instanceof r}}}),f=function(t,r,n,e,u,o,i,a){if(!t){var s;if(void 0===r)s=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,e,u,o,i,a],f=0;(s=Error(r.replace(/%s/g,function(){return c[f++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}};function l(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(0===r.length)return function(t){return t};if(1===r.length)return r[0];var e=r[r.length-1],u=r.slice(0,-1);return function(){return u.reduceRight(function(t,r){return r(t)},e.apply(void 0,arguments))}}var t=function(){function e(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),y=function(t){if(Array.isArray(t)){for(var r=0,n=Array(t.length);r<t.length;r++)n[r]=t[r];return n}return Array.from(t)},h="pending",p="resolved",v="rejected",m=function(){};function b(t,r){t.status=r}function d(t){return"Unhandled Promisynch Rejection: "+t}function g(t){return function(r){try{return b(r.chain,r.err?v:p),t(r)}catch(t){throw r.err=t,r.result=[t],b(r.chain,v),d(t)}}}function j(t){return function(r){try{return t(r)}catch(t){return Object.assign(r,{err:t,result:[t]})}}}function A(t){return function(r){try{return t(r)}catch(t){var n=setTimeout(function(){throw d(t)});return Object.assign(r,{err:t,timer:n,result:[t]})}}}function w(r){return function(t){if(r.apply(void 0,[t.err||null,t.err?null:t.result].concat(y(t.argument))),t.err)throw d(t.err);return t}}function S(r){return function(t){return r.apply(void 0,[t.err||null,t.err?null:t.result].concat(y(t.argument))),t}}function k(n){return function(t){var r=Object.assign({},t);return r.err||(r.result=c.Defined(r.result)?n(r.result):n.apply(void 0,y(r.argument))),r}}function O(n){return function(t){var r=Object.assign({},t);return r.err?(r.timer&&(clearTimeout(r.timer),delete r.timer),r.result=n(r.err),Object.assign(r,{err:null})):r}}var _=function(t,r){var n=l(g,k)(r);return t?l(n,t):n},E=function(t,r){var n=l(O)(r);return t?l(n,j(t)):n},D=function(t,r){var n=l(w)(r);return t?l(n,j(t)):n},I=function(t){return l(A,g,k)(t)},x=function(t){return l(A,O)(t)},P=function(t){return l(A,S)(t)};return function(){function e(t){var n;!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.status=h,this.value=null,this.funcs=null,f(c.Function(n=t),"You must pass a resolver function as the first argument to the chain constructor"),function(t,r){try{n(t,r)}catch(t){r(t)}}(this.resolve.bind(this),this.reject.bind(this))}return t(e,null,[{key:"of",value:function(t){return new e(t||m)}},{key:"resolve",value:function(r){return e.of(function(t){return t(r)})}},{key:"reject",value:function(n){return e.of(function(t,r){return r(n)})}},{key:"all",value:function(t){var n=e.of(),r=Array.from(t);return r.forEach(function(t){t.finally(function(){return function(t){if(n.status===h)if(t.some(function(t){return t.status===v})){var r=t.find(function(t){return t.status===v});n.reject(r.value)}else t.every(function(t){return t.status!==h})&&n.resolve(t.map(function(t){return t.value}))}(r)})}),n}},{key:"race",value:function(t){var n=e.of(),r=Array.from(t);return r.forEach(function(t){t.finally(function(){return function(t){if(n.status===h){var r=t.find(function(t){return t.status!==h});r.status===v?n.reject(r.value):n.resolve(r.value)}}(r)})}),n}}]),t(e,[{key:"resolve",value:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(this.status===h){this.status=p;var e={err:null,result:void 0,argument:r,chain:this};this.value=0===(u=r).length?null:1===u.length?u[0]:u,this.funcs&&(e=this.funcs(e),0===r.length&&(this.value=e.result),delete this.funcs)}var u;return this}},{key:"reject",value:function(t){if(this.status===h){this.status=v;var r={err:t,result:void 0,argument:[t],chain:this};this.value=c.Defined(t)?t:null,this.funcs&&(r=this.funcs(r),c.Undefined(t)&&(this.value=r.result),delete this.funcs)}return this}},{key:"then",value:function(t,r){return this.status===h?(t&&(this.funcs=_(this.funcs,t)),r&&(this.funcs=E(this.funcs,r))):(t&&(this._set=I(t)(this._set),this.value=this._set.result),r&&(this._set=x(r)(this._set),this.value=this._set.result)),this}},{key:"catch",value:function(t){return this.status===h?t&&(this.funcs=E(this.funcs,t)):t&&(this._set=x(t)(this._set),this.value=this._set.result),this}},{key:"finally",value:function(t){return this.status===h?t&&(this.funcs=D(this.funcs,t)):t&&(this._set=P(t)(this._set),this.value=this._set.result),this}}]),e}()});
